generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model expense_categories {
  id_expense_category Int        @id @default(autoincrement())
  name                String     @unique @db.VarChar(40)
  expenses            expenses[]
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model expenses {
  id_expense         Int                @id @default(autoincrement())
  vehicle_id         Int
  category_id        Int
  expense_date       DateTime           @default(dbgenerated("CURRENT_DATE")) @db.Date
  amount             Int
  notes              String?            @db.VarChar(255)
  expense_categories expense_categories @relation(fields: [category_id], references: [id_expense_category], onDelete: NoAction, onUpdate: NoAction, map: "fk_expenses_category")
  vehicles           vehicles           @relation(fields: [vehicle_id], references: [id_vehicle], onDelete: NoAction, onUpdate: NoAction, map: "fk_expenses_vehicle")
}

model incomes {
  id_income    Int       @id @default(autoincrement())
  vehicle_id   Int
  platform_id  Int
  service_date DateTime  @default(dbgenerated("CURRENT_DATE")) @db.Date
  amount       Int
  notes        String?   @db.VarChar(255)
  platforms    platforms @relation(fields: [platform_id], references: [platform_id], onDelete: NoAction, onUpdate: NoAction, map: "fk_incomes_platform")
  vehicles     vehicles  @relation(fields: [vehicle_id], references: [id_vehicle], onDelete: NoAction, onUpdate: NoAction, map: "fk_incomes_vehicle")
}

model platforms {
  platform_id Int         @id @default(autoincrement())
  name        driving_app @unique
  incomes     incomes[]
}

model users {
  id_user       Int        @id @default(autoincrement())
  name          String?    @db.VarChar(100)
  email         String     @unique @db.VarChar(100)
  password_hash String
  created_at    DateTime   @default(now()) @db.Timestamptz(6)
  updated_at    DateTime   @default(now()) @db.Timestamptz(6)
  vehicles      vehicles[]
}

model vehicles {
  id_vehicle         Int                 @id @default(autoincrement())
  user_id            Int
  ownership_type     ownership_type_enum
  weekly_rent_amount Int?
  created_at         DateTime            @default(now()) @db.Timestamptz(6)
  alias              String?             @db.VarChar(100)
  plate              String?             @db.VarChar(10)
  expenses           expenses[]
  incomes            incomes[]
  users              users               @relation(fields: [user_id], references: [id_user], onDelete: NoAction, onUpdate: NoAction, map: "fk_vehicles_user")
}

enum driving_app {
  UBER
  DIDI
  INDRIVER
  YANGO
}

enum ownership_type_enum {
  OWNED
  RENTED
}
